<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Extract values from Raster objects — extract • raster</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Extract values from Raster objects — extract"><meta property="og:description" content="Extract values from a Raster* object at the locations of spatial vector data. There are methods for points, lines, and polygons (classes from `sp` or `sf`), for a matrix or data.frame of points. You can also use cell numbers and Extent (rectangle) objects to extract values.
If y represents points, extract returns the values of a Raster* object for the cells in which a set of points fall.
If y represents lines, the extract method returns the values of the cells of a Raster* object that are touched by a line. If y represents polygons, the extract method returns the values of the cells of a Raster* object that are covered by a polygon. A cell is covered if its center is inside the polygon (but see the weights option for considering partly covered cells; and argument small for getting values for small polygons).
It is also possible to extract values for point locations from SpatialPolygons."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">raster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.6-8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rspatial/raster/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Extract values from Raster objects</h1>
    
    <div class="hidden name"><code>extract.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Extract values from a Raster* object at the locations of spatial vector data. There are methods for points, lines, and polygons (classes from `sp` or `sf`), for a matrix or data.frame of points. You can also use cell numbers and Extent (rectangle) objects to extract values.</p>
<p>If <code>y</code> represents points, <code>extract</code> returns the values of a Raster* object for the cells in which a set of points fall.
If <code>y</code> represents lines, the <code>extract</code> method returns the values of the cells of a Raster* object that are touched by a line. If <code>y</code> represents polygons, the <code>extract</code> method returns the values of the cells of a Raster* object that are covered by a polygon. A cell is covered if its center is inside the polygon (but see the <code>weights</code> option for considering partly covered cells; and argument <code>small</code> for getting values for small polygons).</p>
<p>It is also possible to extract values for point locations from SpatialPolygons.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for Raster,matrix</span></span>
<span><span class="fu">extract</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, method<span class="op">=</span><span class="st">'simple'</span>, buffer<span class="op">=</span><span class="cn">NULL</span>, small<span class="op">=</span><span class="cn">FALSE</span>, cellnumbers<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>   fun<span class="op">=</span><span class="cn">NULL</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">layer</span>, <span class="va">nl</span>, df<span class="op">=</span><span class="cn">FALSE</span>, factors<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for Raster,SpatialLines</span></span>
<span><span class="fu">extract</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fun<span class="op">=</span><span class="cn">NULL</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, cellnumbers<span class="op">=</span><span class="cn">FALSE</span>, df<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">layer</span>,</span>
<span>   <span class="va">nl</span>, factors<span class="op">=</span><span class="cn">FALSE</span>, along<span class="op">=</span><span class="cn">FALSE</span>, sp<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for Raster,SpatialPolygons</span></span>
<span><span class="fu">extract</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, fun<span class="op">=</span><span class="cn">NULL</span>, na.rm<span class="op">=</span><span class="cn">FALSE</span>, exact<span class="op">=</span><span class="cn">FALSE</span>, weights<span class="op">=</span><span class="cn">FALSE</span>,  </span>
<span>   normalizeWeights<span class="op">=</span><span class="cn">TRUE</span>, cellnumbers<span class="op">=</span><span class="cn">FALSE</span>, small<span class="op">=</span><span class="cn">TRUE</span>, df<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">layer</span>, <span class="va">nl</span>, </span>
<span>   factors<span class="op">=</span><span class="cn">FALSE</span>, sp<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># S4 method for SpatialPolygons,SpatialPoints</span></span>
<span><span class="fu">extract</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Raster* object</p></dd>


<dt>y</dt>
<dd><p>points represented by a two-column matrix or data.frame, or <code>SpatialPoints*</code>; <code>SpatialPolygons*</code>; <code><a href="https://rdrr.io/pkg/sp/man/SpatialLines.html" class="external-link">SpatialLines</a></code>; <code>sf</code> spatial vector objects; <code><a href="Extent-class.html">Extent</a></code>; or a numeric vector representing cell numbers</p></dd>


<dt>method</dt>
<dd><p>character. <code>'simple'</code> or <code>'bilinear'</code>. If <code>'simple'</code> values for the cell a point falls in are returned. If <code>'bilinear'</code> the returned values are interpolated from the values of the four nearest raster cells.</p></dd>


<dt>buffer</dt>
<dd><p>numeric. The radius of a buffer around each point from which to extract cell values. If the distance between the sampling point and the center of a cell is less than or equal to the buffer, the cell is included. The buffer can be specified as a single value, or as a vector of the length of the number of points.  If the data are not projected (latitude/longitude), the unit should be meters. Otherwise it should be in map-units (typically also meters).</p></dd>
  

<dt>small</dt>
<dd><p>logical. If <code>TRUE</code> and <code>y</code> represents points and a <code>buffer</code> argument is used, the function always return a number, also when the buffer does not include the center of a single cell. The value of the cell in which the point falls is returned if no cell center is within the buffer. If <code>y</code> represents polygons, a value is also returned for relatively small polygons (e.g. those smaller than a single cell of the Raster* object), or polygons with an odd shape, for which otherwise no values are returned because they do not cover any raster cell centers. In some cases, you could alternatively use the centroids of such polygons, for example using <code>extract(x, coordinates(y))</code> or <code>extract(x, coordinates(y), method='bilinear')</code>.</p></dd>


<dt>fun</dt>
<dd><p>function to summarize the values (e.g. <code>mean</code>). The function should take a single numeric vector as argument and return a single value (e.g. mean, min or max), and accept a <code>na.rm</code> argument. Thus, standard R functions not including an na.rm argument must be wrapped as in this example: fun=function(x,...)length(x). If <code>y</code> represents points, <code>fun</code> is only used when a buffer is used (and hence multiple values per spatial feature would otherwise be returned).</p></dd>
 

<dt>na.rm</dt>
<dd><p>logical. Only useful when an argument <code>fun</code> is supplied. If <code>na.rm=TRUE</code> (the default value), NA values are removed before fun is applied. This argument may be ignored if the function used has a <code>...</code> argument and ignores an additional <code>na.rm</code> argument</p></dd>


<dt>cellnumbers</dt>
<dd><p>logical. If <code>cellnumbers=TRUE</code>, cell-numbers will also be returned (if no <code>fun</code> argument is  supplied, and when extracting values with points, if <code>buffer</code> is <code>NULL</code>)</p></dd>


<dt>df</dt>
<dd><p>logical. If <code>df=TRUE</code>, results will be returned as a data.frame. The first column is a sequential ID, the other column(s) are the extracted values</p></dd>


<dt>exact</dt>
<dd><p>logical. If <code>TRUE</code> the fraction of each cell that is (partly) covered by the polygon is extracted, not only the cells of which the centers are covered. This option is particularly useful if the polygons are small relative to the cells size of the Raster* object</p></dd>


<dt>weights</dt>
<dd><p>logical. If <code>TRUE</code> the fraction of a cell that is covered is returned or used by <code>fun</code>. These can be used as weights can be used for averaging; see examples. If <code>exact</code> is <code>FALSE</code>, this is the approximate fraction of each cell that is covered by the polygon, rounded to 1/100</p></dd>


<dt>normalizeWeights</dt>
<dd><p>logical. If <code>TRUE</code>, weights are normalized such that they add up to one for each polygon</p></dd>


<dt>factors</dt>
<dd><p>logical. If <code>TRUE</code>, factor values are returned, else their integer representation is returned</p></dd>


<dt>layer</dt>
<dd><p>integer. First layer for which you want values (if <code>x</code> is a multilayer object)</p></dd>


<dt>nl</dt>
<dd><p>integer. Number of layers for which you want values (if <code>x</code> is a multilayer object)</p></dd>


<dt>along</dt>
<dd><p>boolean. Should returned values be ordered to go along the lines?</p></dd>


<dt>sp</dt>
<dd><p>boolean. Should the extracted values be added to the data.frame of the Spatial* object <code>y</code>? This only applies if <code>y</code> is a Spatial* object and, for SpatialLines and SpatialPolygons, if <code>fun</code> is not NULL. In this case the returned value is the expanded Spatial object</p></dd>



<dt>...</dt>
<dd><p>additional arguments (none implemented)</p></dd>
  
</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A vector for RasterLayer objects, and a matrix for RasterStack or RasterBrick objects. A list (or a data.frame if <code>df=TRUE</code>) if <code>y</code> is a SpatialPolygons* or SpatialLines* object or if a <code>buffer</code> argument is used (but not a <code>fun</code> argument). If <code>sp=TRUE</code> and  <code>y</code> is a Spatial* object and  <code>fun</code> is not NULL a Spatial* object is returned. The order of the returned values corresponds to the order of object <code>y</code>. If <code>df=TRUE</code>, this is also indicated in the first variable ('ID').</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getValues.html">getValues</a>, <a href="getValuesFocal.html">getValuesFocal</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="raster.html">raster</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">36</span>, nrow<span class="op">=</span><span class="fl">18</span>, vals<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">18</span><span class="op">*</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="co"># extract values by cell number</span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]   1   2  10 100</span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="stack.html">stack</a></span><span class="op">(</span><span class="va">r</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="va">r</span><span class="op">/</span><span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">s</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>, layer<span class="op">=</span><span class="fl">2</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        layer.2 layer.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.000000       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  3.162278       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 10.000000       1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="co"># extract values with points</span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">80</span>, <span class="fl">80</span>, by<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 626 554 482 410 338 266 194 122  50</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu">SpatialPoints</span><span class="op">(</span><span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">sp</span>, method<span class="op">=</span><span class="st">'bilinear'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 607.5 535.5 463.5 391.5 319.5 247.5 175.5 103.5  31.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># examples with a buffer</span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>, buffer<span class="op">=</span><span class="fl">1000000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 586 587 588 589 590 591 592 593 620 621 622 623 624 625 626 627 628 629 630</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 517 518 552 553 554 555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 445 446 481 482</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">xy</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>, buffer<span class="op">=</span><span class="fl">1000000</span>, fun<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 611.1 541.5 463.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## illustrating the varying size of a buffer (expressed in meters) </span></span></span>
<span class="r-in"><span><span class="co">## on a longitude/latitude raster</span></span></span>
<span class="r-in"><span> <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">xy</span>, buffer<span class="op">=</span><span class="fl">1000000</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="raster.html">raster</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">s</span><span class="op">[</span><span class="va">z</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">}</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">## compare with raster that is not longitude/latitude</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="projection.html">crs</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"+proj=utm +zone=17"</span> </span></span>
<span class="r-in"><span> <span class="va">xy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span> <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">xy</span>, buffer<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="va">s</span><span class="op">[</span><span class="va">z</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">}</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="extract-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># library(maptools)</span></span></span>
<span class="r-in"><span><span class="co"># data(wrld_simpl)</span></span></span>
<span class="r-in"><span><span class="co"># plot(wrld_simpl, add=TRUE)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="co"># extract values with lines</span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="raster.html">raster</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">36</span>, nrow<span class="op">=</span><span class="fl">18</span>, vals<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">18</span><span class="op">*</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">50</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="op">-</span><span class="fl">45</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">140</span>,<span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">160</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">140</span>,<span class="op">-</span><span class="fl">55</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="spEasy.html">spLines</a></span><span class="op">(</span><span class="va">cds1</span>, <span class="va">cds2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">lines</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 126 127 161 162 163 164 196 197 200 201 231 232 237 266 267 273 274 302 310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 311 338 346 381 382 414 417 450 451 452 453 487 488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 139 140 141 174 175 177 208 209 210 213 243 244 249 250 279 286 322 358 359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20] 394 429 430 465 501 537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="co"># extract values with polygons</span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="va">cds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>,<span class="op">-</span><span class="fl">20</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">160</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">60</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">160</span>,<span class="op">-</span><span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>,<span class="op">-</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>,<span class="op">-</span><span class="fl">55</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">polys</span> <span class="op">&lt;-</span> <span class="fu"><a href="spEasy.html">spPolygons</a></span><span class="op">(</span><span class="va">cds1</span>, <span class="va">cds2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">polys</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># mean for each polygon</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">v</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="kw">else</span> <span class="cn">NA</span> <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 387.8158 329.3913</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># v &lt;- extract(r, polys, cellnumbers=TRUE)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># weighted mean</span></span></span>
<span class="r-in"><span><span class="co"># v &lt;- extract(r, polys, weights=TRUE, fun=mean)</span></span></span>
<span class="r-in"><span><span class="co"># equivalent to:</span></span></span>
<span class="r-in"><span><span class="co"># v &lt;- extract(r, polys, weights=TRUE)</span></span></span>
<span class="r-in"><span><span class="co"># sapply(v, function(x) if (!is.null(x)) {sum(apply(x, 1, prod)) / sum(x[,2])} else NA)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="co"># extract values with an extent</span></span></span>
<span class="r-in"><span><span class="co">###############################</span></span></span>
<span class="r-in"><span><span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="extent.html">extent</a></span><span class="op">(</span><span class="fl">150</span>,<span class="fl">170</span>,<span class="op">-</span><span class="fl">60</span>,<span class="op">-</span><span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">extract</span><span class="op">(</span><span class="va">r</span>, <span class="va">e</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 502 503 538 539</span>
<span class="r-in"><span><span class="co">#plot(r)</span></span></span>
<span class="r-in"><span><span class="co">#plot(e, add=T)</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert J. Hijmans.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

